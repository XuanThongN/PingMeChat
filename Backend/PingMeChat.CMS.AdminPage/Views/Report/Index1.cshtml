<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Báo cáo tổng quan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }

        .content {
            padding: 20px;
        }

        .header {
            background-color: white;
            padding: 10px;
            margin-bottom: 20px;
        }

        .card {
            background-color: white;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .summary-box {
            background-color: #e6f3ff;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .chart-container {
            height: 300px;
        }

        table {
            width: 100%;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .btn-custom {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <div class="header">
                <h5>Báo cáo tổng quan</h5>
            </div>
            <div class="card">
                <div class="row">
                    <div class="col-md-3">
                        <div class="summary-box">
                            <h6>CHI PHÍ</h6>
                            <h3 id="totalCost">0</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="summary-box">
                            <h6>SỐ ĐOÀN HÀNG ĐI</h6>
                            <h3 id="totalOrders">0</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="summary-box">
                            <h6>DOANH THU</h6>
                            <h3 id="totalRevenue">0</h3>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="summary-box">
                            <h6>LỢI NHUẬN</h6>
                            <h3 id="totalProfit">0</h3>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
            <div class="card">
                <h5>Báo cáo theo ngày</h5>
                <div class="mb-3">
                    <input type="date" id="reportDate" class="form-control d-inline-block w-auto">
                    <button class="btn btn-custom" onclick="generateReport()">Xem</button>
                    <button class="btn btn-custom" onclick="exportReport()">Xuất báo cáo</button>
                </div>
                <table id="dailyReportTable">
                    <thead>
                        <tr>
                            <th>NGÀY</th>
                            <th>DOANH THU</th>
                            <th>HOÀN TIỀN</th>
                            <th>GIẢM GIÁ</th>
                            <th>DOANH THU THUẦN</th>
                            <th>ĐƠN VỊ/ KHÁCH HÀNG</th>
                            <th>LỢI NHUẬN</th>
                            <th>TỈ LỆ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be inserted here -->
                    </tbody>
                </table>
            </div>
            <div class="card">
                <h5>Sản phẩm - Dịch vụ</h5>
                <div class="mb-3">
                    <select id="productCategory" class="form-select d-inline-block w-auto">
                        <option value="all">Tất cả</option>
                        <option value="product">Sản phẩm</option>
                        <option value="service">Dịch vụ</option>
                    </select>
                    <input type="date" id="productDate" class="form-control d-inline-block w-auto">
                    <input type="text" id="productSearch" class="form-control d-inline-block w-auto" placeholder="Tìm kiếm theo tên">
                    <button class="btn btn-custom" onclick="searchProducts()">Xem</button>
                </div>
                <table id="productTable">
                    <thead>
                        <tr>
                            <th>SẢN PHẨM</th>
                            <th>SỐ LƯỢNG</th>
                            <th>DOANH THU</th>
                            <th>LỢI NHUẬN</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Dữ liệu mẫu
        const sampleData = {
            dailyReport: [
                { date: '2024-07-02', revenue: 10000000, refund: 500000, discount: 200000, netRevenue: 9300000, customers: 50, profit: 3000000, rate: '32.26%' },
                { date: '2024-07-01', revenue: 9500000, refund: 300000, discount: 150000, netRevenue: 9050000, customers: 45, profit: 2800000, rate: '30.94%' }
            ],
            products: [
                { name: 'Sản phẩm A', category: 'product', quantity: 100, revenue: 5000000, profit: 1500000 },
                { name: 'Dịch vụ B', category: 'service', quantity: 50, revenue: 2500000, profit: 1000000 },
                { name: 'Sản phẩm C', category: 'product', quantity: 75, revenue: 3750000, profit: 1200000 }
            ]
        };

        // Hàm để cập nhật tổng quan
        function updateSummary() {
            const totalCost = sampleData.dailyReport.reduce((sum, day) => sum + day.revenue - day.profit, 0);
            const totalOrders = sampleData.dailyReport.reduce((sum, day) => sum + day.customers, 0);
            const totalRevenue = sampleData.dailyReport.reduce((sum, day) => sum + day.revenue, 0);
            const totalProfit = sampleData.dailyReport.reduce((sum, day) => sum + day.profit, 0);

            document.getElementById('totalCost').textContent = totalCost.toLocaleString() + ' đ';
            document.getElementById('totalOrders').textContent = totalOrders;
            document.getElementById('totalRevenue').textContent = totalRevenue.toLocaleString() + ' đ';
            document.getElementById('totalProfit').textContent = totalProfit.toLocaleString() + ' đ';
        }

        // Hàm để tạo báo cáo theo ngày
        function generateReport() {
            const reportDate = document.getElementById('reportDate').value;
            const tableBody = document.querySelector('#dailyReportTable tbody');
            tableBody.innerHTML = '';

            const reportData = sampleData.dailyReport.filter(day => day.date === reportDate);

            if (reportData.length > 0) {
                reportData.forEach(day => {
                    const row = `<tr>
                                <td>${day.date}</td>
                                <td>${day.revenue.toLocaleString()} đ</td>
                                <td>${day.refund.toLocaleString()} đ</td>
                                <td>${day.discount.toLocaleString()} đ</td>
                                <td>${day.netRevenue.toLocaleString()} đ</td>
                                <td>${day.customers}</td>
                                <td>${day.profit.toLocaleString()} đ</td>
                                <td>${day.rate}</td>
                            </tr>`;
                    tableBody.innerHTML += row;
                });
            } else {
                tableBody.innerHTML = '<tr><td colspan="8">Không có dữ liệu cho ngày này</td></tr>';
            }
        }

        // Hàm để tìm kiếm sản phẩm
        function searchProducts() {
            const category = document.getElementById('productCategory').value;
            const date = document.getElementById('productDate').value;
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();

            const filteredProducts = sampleData.products.filter(product =>
                (category === 'all' || product.category === category) &&
                product.name.toLowerCase().includes(searchTerm)
            );

            const tableBody = document.querySelector('#productTable tbody');
            tableBody.innerHTML = '';

            if (filteredProducts.length > 0) {
                filteredProducts.forEach(product => {
                    const row = `<tr>
                                <td>${product.name}</td>
                                <td>${product.quantity}</td>
                                <td>${product.revenue.toLocaleString()} đ</td>
                                <td>${product.profit.toLocaleString()} đ</td>
                            </tr>`;
                    tableBody.innerHTML += row;
                });
            } else {
                tableBody.innerHTML = '<tr><td colspan="4">Không tìm thấy sản phẩm phù hợp</td></tr>';
            }
        }

        // Hàm để xuất báo cáo (giả lập)
        function exportReport() {
            alert('Báo cáo đã được xuất thành công!');
        }

        // Biểu đồ doanh thu
        var ctx = document.getElementById('revenueChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['00:00', '02:00', '04:00', '06:00', '08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00', '22:00'],
                datasets: [{
                    label: 'Chi phí',
                    data: [100000, 150000, 200000, 180000, 220000, 250000, 300000, 280000, 260000, 220000, 180000, 150000],
                    borderColor: 'red',
                    fill: false
                }, {
                    label: 'Doanh thu',
                    data: [150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 480000, 420000, 380000, 300000],
                    borderColor: 'blue',
                    fill: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Khởi tạo trang
        updateSummary();
        generateReport();
        searchProducts();
    </script>
</body>
</html>